<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Music45</title>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #111;
      color: #fff;
      margin: 0;
      padding: 0;
    }
    header {
      padding: 10px;
      background: #222;
      text-align: center;
    }
    #search-bar {
      width: 90%;
      padding: 10px;
      font-size: 16px;
      border: none;
      border-radius: 8px;
    }
    #songs-list {
      padding: 20px;
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
      gap: 15px;
    }
    .song-card {
      background: #1c1c1c;
      padding: 10px;
      border-radius: 12px;
      text-align: center;
      cursor: pointer;
      transition: transform 0.2s;
    }
    .song-card:hover {
      transform: scale(1.05);
    }
    .song-card img {
      width: 100%;
      border-radius: 12px;
    }
    .song-title {
      margin-top: 8px;
      font-weight: bold;
      font-size: 14px;
    }
    .song-artist {
      font-size: 12px;
      color: #bbb;
    }
    /* Footer Player */
    footer {
      position: fixed;
      bottom: 0;
      left: 0;
      width: 100%;
      background: #222;
      padding: 10px;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    .controls button {
      background: none;
      border: none;
      color: white;
      font-size: 18px;
      margin: 0 8px;
      cursor: pointer;
    }
    .progress-container {
      flex-grow: 1;
      margin: 0 15px;
      height: 5px;
      background: #444;
      border-radius: 5px;
      cursor: pointer;
    }
    .progress {
      height: 100%;
      background: #1db954;
      width: 0;
      border-radius: 5px;
    }
    /* Banner Player */
    #music-banner {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: #111;
      z-index: 999;
      padding: 20px;
      text-align: center;
    }
    #music-banner img {
      width: 250px;
      border-radius: 20px;
      margin-top: 50px;
    }
    #music-banner h2 {
      margin: 20px 0 10px;
    }
    #music-banner p {
      color: #bbb;
    }
    #close-banner-btn {
      position: absolute;
      top: 15px;
      right: 15px;
      font-size: 24px;
      background: none;
      border: none;
      color: white;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <header>
    <input type="text" id="search-bar" placeholder="Search songs...">
  </header>

  <main id="songs-list"></main>

  <!-- Footer Player -->
  <footer>
    <button id="prev"><i class="fas fa-backward"></i></button>
    <button id="play-pause"><i class="fas fa-play"></i></button>
    <button id="next"><i class="fas fa-forward"></i></button>
    <div class="progress-container" id="progress-bar">
      <div class="progress" id="progress"></div>
    </div>
    <button id="toggle-banner"><i class="fas fa-up-right-and-down-left-from-center"></i></button>
  </footer>

  <!-- Banner Player -->
  <div id="music-banner">
    <button id="close-banner-btn"><i class="fas fa-times"></i></button>
    <img id="banner-cover" src="">
    <h2 id="banner-title"></h2>
    <p id="banner-artist"></p>
    <div>
      <button id="banner-prev"><i class="fas fa-backward"></i></button>
      <button id="banner-play-pause"><i class="fas fa-play"></i></button>
      <button id="banner-next"><i class="fas fa-forward"></i></button>
    </div>
    <div class="progress-container" id="banner-progress-bar">
      <div class="progress" id="banner-progress"></div>
    </div>
  </div>

  <audio id="audio-player"></audio>

  <script>
    const CLIENT_ID = "7afe6b39346f4bcc8654c141fe2a6136";
    const CLIENT_SECRET = "119278484c2f4c28ac893ea3324bfe84";

    let token = "";
    let audio = document.getElementById("audio-player");
    let isPlaying = false;
    let currentIndex = 0;
    let songQueue = [];

    async function getToken() {
      const result = await fetch("https://accounts.spotify.com/api/token", {
        method: "POST",
        headers: {
          "Content-Type": "application/x-www-form-urlencoded",
          "Authorization": "Basic " + btoa(CLIENT_ID + ":" + CLIENT_SECRET)
        },
        body: "grant_type=client_credentials"
      });
      const data = await result.json();
      token = data.access_token;
    }

    async function searchSongs(query) {
      const result = await fetch(`https://api.spotify.com/v1/search?q=${query}&type=track&limit=12`, {
        headers: { Authorization: "Bearer " + token }
      });
      const data = await result.json();
      displaySongs(data.tracks.items);
    }

    function displaySongs(songs) {
      const list = document.getElementById("songs-list");
      list.innerHTML = "";
      songQueue = [];
      songs.forEach((song, index) => {
        const card = document.createElement("div");
        card.className = "song-card";
        card.innerHTML = `
          <img src="${song.album.images[0].url}">
          <div class="song-title">${song.name}</div>
          <div class="song-artist">${song.artists[0].name}</div>
        `;
        card.addEventListener("click", () => playSong(index));
        list.appendChild(card);
        songQueue.push({
          title: song.name,
          artist: song.artists[0].name,
          cover: song.album.images[0].url,
          preview_url: song.preview_url
        });
      });
    }

    function playSong(index) {
      if (!songQueue[index].preview_url) {
        alert("No preview available for this song");
        return;
      }
      currentIndex = index;
      audio.src = songQueue[index].preview_url;
      audio.play();
      isPlaying = true;
      updateUI(songQueue[index]);
    }

    function playPause() {
      if (audio.paused) {
        audio.play();
        isPlaying = true;
        updatePlayIcons(true);
      } else {
        audio.pause();
        isPlaying = false;
        updatePlayIcons(false);
      }
    }

    function updatePlayIcons(state) {
      document.getElementById("play-pause").innerHTML = state ? '<i class="fas fa-pause"></i>' : '<i class="fas fa-play"></i>';
      document.getElementById("banner-play-pause").innerHTML = state ? '<i class="fas fa-pause"></i>' : '<i class="fas fa-play"></i>';
    }

    function updateUI(song) {
      document.getElementById("banner-cover").src = song.cover;
      document.getElementById("banner-title").textContent = song.title;
      document.getElementById("banner-artist").textContent = song.artist;
      updatePlayIcons(true);
    }

    function nextSong() {
      currentIndex = (currentIndex + 1) % songQueue.length;
      playSong(currentIndex);
    }
    function prevSong() {
      currentIndex = (currentIndex - 1 + songQueue.length) % songQueue.length;
      playSong(currentIndex);
    }

    // Progress update
    setInterval(() => {
      if (isPlaying && audio.duration) {
        document.getElementById("progress").style.width = (audio.currentTime / audio.duration) * 100 + "%";
        document.getElementById("banner-progress").style.width = (audio.currentTime / audio.duration) * 100 + "%";
      }
    }, 500);

    document.getElementById("progress-bar").addEventListener("click", e => {
      const rect = e.target.getBoundingClientRect();
      const percent = (e.clientX - rect.left) / rect.width;
      audio.currentTime = audio.duration * percent;
    });
    document.getElementById("banner-progress-bar").addEventListener("click", e => {
      const rect = e.target.getBoundingClientRect();
      const percent = (e.clientX - rect.left) / rect.width;
      audio.currentTime = audio.duration * percent;
    });

    // Controls
    document.getElementById("play-pause").addEventListener("click", playPause);
    document.getElementById("banner-play-pause").addEventListener("click", playPause);
    document.getElementById("next").addEventListener("click", nextSong);
    document.getElementById("banner-next").addEventListener("click", nextSong);
    document.getElementById("prev").addEventListener("click", prevSong);
    document.getElementById("banner-prev").addEventListener("click", prevSong);

    // Banner toggle
    document.getElementById("toggle-banner").addEventListener("click", () => {
      document.getElementById("music-banner").style.display = "block";
    });
    document.getElementById("close-banner-btn").addEventListener("click", () => {
      document.getElementById("music-banner").style.display = "none";
    });

    // Search handler
    document.getElementById("search-bar").addEventListener("keyup", e => {
      if (e.key === "Enter") {
        searchSongs(e.target.value);
      }
    });

    // Init
    getToken().then(() => searchSongs("Arijit Singh"));
  </script>
</body>
</html>
