<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Music45 - JioSaavn Player</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- FontAwesome for icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background: #111;
      color: #fff;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 10px;
    }
    header {
      font-size: 24px;
      font-weight: bold;
      margin: 10px;
      color: #1db954;
    }
    #search-box {
      width: 90%;
      padding: 10px;
      border: none;
      border-radius: 20px;
      outline: none;
      margin-bottom: 15px;
      font-size: 16px;
    }
    #results {
      width: 100%;
      max-width: 600px;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }
    .song {
      display: flex;
      align-items: center;
      background: #222;
      padding: 10px;
      border-radius: 10px;
      cursor: pointer;
      transition: background 0.3s;
    }
    .song:hover { background: #333; }
    .song img {
      width: 60px;
      height: 60px;
      border-radius: 8px;
      margin-right: 10px;
    }
    .song-info {
      display: flex;
      flex-direction: column;
    }
    #player {
      position: fixed;
      bottom: 0;
      width: 100%;
      background: #000;
      padding: 15px;
      display: flex;
      flex-direction: column;
      align-items: center;
      border-top: 2px solid #1db954;
    }
    #player img {
      width: 100px;
      height: 100px;
      border-radius: 10px;
      margin-bottom: 10px;
    }
    #controls {
      display: flex;
      gap: 20px;
      margin-top: 10px;
    }
    #controls i {
      font-size: 24px;
      cursor: pointer;
    }
    audio { display: none; }
  </style>
</head>
<body>
  <header>ðŸŽµ Music45 - JioSaavn</header>

  <input type="text" id="search-box" placeholder="Search songs...">

  <div id="results"></div>

  <div id="player" style="display:none;">
    <img id="cover" src="">
    <div id="song-title"></div>
    <div id="song-artist" style="color:gray; font-size:14px;"></div>
    <div id="controls">
      <i id="prev" class="fa-solid fa-backward"></i>
      <i id="play" class="fa-solid fa-play"></i>
      <i id="next" class="fa-solid fa-forward"></i>
    </div>
    <audio id="audio" controls></audio>
  </div>

  <script>
    const searchBox = document.getElementById("search-box");
    const results = document.getElementById("results");
    const player = document.getElementById("player");
    const audio = document.getElementById("audio");
    const cover = document.getElementById("cover");
    const titleEl = document.getElementById("song-title");
    const artistEl = document.getElementById("song-artist");
    const playBtn = document.getElementById("play");
    const nextBtn = document.getElementById("next");
    const prevBtn = document.getElementById("prev");

    let currentSongs = [];
    let currentIndex = 0;

    // Search songs
    searchBox.addEventListener("keyup", async (e) => {
      if (e.key === "Enter") {
        const query = searchBox.value.trim();
        if (!query) return;
        results.innerHTML = "Searching...";
        const res = await fetch(`https://saavn.dev/api/search/songs?query=${encodeURIComponent(query)}`);
        const data = await res.json();
        currentSongs = data.data.results;
        showResults(currentSongs);
      }
    });

    function showResults(songs) {
      results.innerHTML = "";
      songs.forEach((song, index) => {
        const div = document.createElement("div");
        div.className = "song";
        div.innerHTML = `
          <img src="${song.image[2].url}" />
          <div class="song-info">
            <strong>${song.name}</strong>
            <small>${song.primaryArtists}</small>
          </div>
        `;
        div.onclick = () => playSong(index);
        results.appendChild(div);
      });
    }

    async function playSong(index) {
      currentIndex = index;
      const song = currentSongs[index];
      // Get full details (with playable link)
      const res = await fetch(`https://saavn.dev/api/songs?id=${song.id}`);
      const data = await res.json();
      const details = data.data[0];

      titleEl.textContent = details.name;
      artistEl.textContent = details.primaryArtists;
      cover.src = details.image[2].url;
      audio.src = details.downloadUrl[4].url; // 320kbps link
      audio.play();

      playBtn.classList.replace("fa-play", "fa-pause");
      player.style.display = "flex";
    }

    playBtn.onclick = () => {
      if (audio.paused) {
        audio.play();
        playBtn.classList.replace("fa-play", "fa-pause");
      } else {
        audio.pause();
        playBtn.classList.replace("fa-pause", "fa-play");
      }
    };

    nextBtn.onclick = () => {
      if (currentIndex < currentSongs.length - 1) playSong(currentIndex + 1);
    };
    prevBtn.onclick = () => {
      if (currentIndex > 0) playSong(currentIndex - 1);
    };
  </script>
</body>
</html>
